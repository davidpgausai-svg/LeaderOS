# StrategicFlow

A minimal, Campfire-style self-hosted SaaS application for strategic planning and project management.

## Features

- **Email/Password Authentication** with JWT tokens
- **Strategies** - Define high-level strategic goals
- **Projects** - Break strategies into actionable projects
- **Actions** - Track specific tasks within projects
- **SQLite Database** - Lightweight, file-based persistence

## Quick Start

### Local Development

```bash
# Install dependencies
npm install

# Run development server
npx tsx src/server.ts

# Build for production
npx tsc

# Run production server
NODE_ENV=production node dist/server.js
```

The app runs on port 5000 by default.

### Docker

```bash
# Build the image
docker build -t strategicflow .

# Run the container
docker run -p 3000:3000 -v strategicflow-data:/data -e JWT_SECRET=your-secret-here strategicflow
```

## Environment Variables

| Variable | Description | Required |
|----------|-------------|----------|
| `JWT_SECRET` | Secret key for JWT token signing | Yes (production) |
| `PORT` | Server port (default: 5000) | No |
| `DB_PATH` | SQLite database path (default: ./data/StrategicFlow.sqlite) | No |
| `NODE_ENV` | Set to 'production' for production builds | No |

## API Endpoints

### Authentication

- `POST /auth/register` - Register new user
- `POST /auth/login` - Login and receive JWT token

### Strategies

- `GET /api/strategies` - List all strategies
- `GET /api/strategies/:id` - Get single strategy
- `POST /api/strategies` - Create strategy (requires auth)
- `PUT /api/strategies/:id` - Update strategy (requires auth)
- `DELETE /api/strategies/:id` - Delete strategy (requires auth)

### Projects

- `GET /api/projects` - List all projects
- `GET /api/projects?strategy_id=:id` - List projects for strategy
- `GET /api/projects/:id` - Get single project
- `POST /api/projects` - Create project (requires auth)
- `PUT /api/projects/:id` - Update project (requires auth)
- `DELETE /api/projects/:id` - Delete project (requires auth)

### Actions

- `GET /api/actions` - List all actions
- `GET /api/actions?project_id=:id` - List actions for project
- `GET /api/actions/:id` - Get single action
- `POST /api/actions` - Create action (requires auth)
- `PUT /api/actions/:id` - Update action (requires auth)
- `DELETE /api/actions/:id` - Delete action (requires auth)

## DigitalOcean App Platform Deployment

1. Push code to GitHub
2. Create new App in DigitalOcean App Platform
3. Select your repository
4. Add environment variable: `JWT_SECRET`
5. Deploy

The `.do/app.yaml` file contains the complete deployment configuration with a persistent volume mounted at `/data` for the SQLite database.

## Project Structure

```
/
├── src/
│   ├── server.ts          # Main entry point
│   ├── db/
│   │   └── index.ts       # SQLite database + schema
│   ├── auth/
│   │   ├── register.ts    # User registration
│   │   ├── login.ts       # User login
│   │   └── withAuth.ts    # JWT middleware
│   └── api/
│       ├── strategies.ts  # Strategies CRUD
│       ├── projects.ts    # Projects CRUD
│       └── actions.ts     # Actions CRUD
├── public/
│   ├── css/
│   │   └── style.css      # Application styles
│   └── pages/
│       ├── login.html     # Login page
│       ├── register.html  # Registration page
│       └── dashboard.html # Main dashboard
├── data/                  # SQLite database directory (auto-created)
├── dist/                  # Compiled JavaScript (generated by tsc)
├── .do/
│   └── app.yaml          # DigitalOcean App Platform config
├── Dockerfile            # Docker configuration (Node 18 Alpine)
├── tsconfig.json
└── README.md
```

## License

MIT
